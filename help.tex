\documentclass[10pt]{article}
\usepackage[a4paper, total={17cm, 25cm}]{geometry}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage[document]{ragged2e}
\usepackage{setspace}
\usepackage{mathtools}
\newcommand\tab[1][1cm]{\hspace*{#1}}
\begin{document}
\section{ }
Q1. a) Convert to simple English sentences
\break \break
i) \break
$\pi_{sname}($

\tab$\pi_{sid}($

\tab\tab $(\sigma_{tagname='PPE'}ProductTag)\bowtie(\sigma_{cost<6}Catalog)$

\tab $) \bowtie Suppliers$

$)$
\break \break
Get the names of the suppliers that have PPE that costs less than 6.
\break
[Outputs the suppliers that have products tagged with 'PPE' and a cost of less than 6]
\break \break
ii)

$\pi_{sname}($

\tab$\pi_{sid}($

\tab\tab $(\sigma_{tagname='PPE'}ProductTag)\bowtie(\sigma_{cost<6}Catalog) \bowtie Suppliers$

\tab $)$

$)$
\break \break
Nothing is returned from this operation.
\break
[$(\sigma_{tagname='PPE'}ProductTag)\bowtie(\sigma_{cost<6}Catalog)$ returns the products with tag PPE and cost < 6, columns are: tid, pid, tagname, sid, pid, cost. Natural join with supplier looks at common sid, so that returns the suppliers with products of tag PPE and cost < 6. Projecting sid will result in each tuple only having an sid. Projecting the sname of a table where the tuples have only sid results in nothing being returned.]
\break \break
iii)

$\pi_{sname}($

\tab $(\sigma_{tagname = 'PPE'}ProductTag)\bowtie(\sigma_{cost < 6} Catalog)\bowtie Suppliers$

$)$ $\cap$ $\pi_{sname}($

\tab$(\sigma_{tagname = 'SuperTech'}ProductTag)\bowtie(\sigma_{cost < 6} Catalog)\bowtie Suppliers$

$)$
\break \break
Gets the names of the suppliers that offer PPE made by SuperTech that costs less than 6.
\break \break
iv)

$\pi_{sid}($

\tab $(\sigma_{tagname = 'PPE'}ProductTag)\bowtie(\sigma_{cost < 6} Catalog)\bowtie Suppliers$

$)$ $\cup$ $\pi_{sid}($

\tab$(\sigma_{tagname = 'SuperTech'}ProductTag)\bowtie(\sigma_{cost < 6} Catalog)\bowtie Suppliers$

$)$
\break \break
Gets the supplier IDs of suppliers that offer PPE or (inclusive) SuperTech products, both having a cost less than 6.
\break \break
v)

$\pi_{sname} ($

\tab $(\pi_{sid, sname} ($

\tab \tab $(\sigma_{tagname='PPE'}ProductTag)\bowtie(\sigma_{cost<6}Catalog)\bowtie Suppliers)$

\tab $) \cap (\pi_{sid, sname} ($

\tab \tab $(\sigma_{tagname='SuperTech'}ProductTag)\bowtie(\sigma_{cost<6}Catalog)\bowtie Suppliers)$

\tab $)$

$)$
\break \break
Get the names of the suppliers that offer PPE made up SuperTech with a cost less than 6.

\break \break

Q1. b) Write relational algebra
\break \break
i) $\pi_{sname}(\sigma_{(tagname='PPE') \vee (tagname ='Testing')}ProductTag \bowtie Catalog \bowtie Suppliers)$
\\~\\
ii) $\pi_{sid}((\sigma_{tagname='PPE'}ProductTag) \bowtie (\sigma_{cost<10 \wedge cost>420}Catalog) \bowtie Suppliers))$
\\~\\
iii)
$\pi_{sid}((\sigma_{tagname='PPE'}ProductTag) \bowtie (\sigma_{cost\geq 10 \wedge cost \leq 1337}Catalog) \bowtie Suppliers))\;$
\\~\\
iv)
\newline
$R1 := \sigma_{tagname='Cleaning'}ProductTag$
\newline
$R2 := \pi_{sid, pid}(R1 \bowtie Catalog$)
\newline
$R3 := \pi_{pid}(R1 \bowtie Catalog)$

$R4 := R2\div R3$
\newline

(or without $\div$)

$R4 := \pi_{R1.sid,\; Suppliers.pid}(R2 \times Suppliers)$

$R5 := \rho_{R4(sid, pid)}(R4)$

$R6 := \pi_{sid}(R5 - R2)$

$R7 := \pi_{sid}(Suppliers) - R6$
\\~\\
v)

$R1 := \rho_{S1}(\rho_{(sid, cost)}(\pi_{Suppliers.sid, Catalog.cost}(Catalog \bowtie Product)))$

$R2 := \rho_{S2}(\rho_{(sid, cost)}(\pi_{Suppliers.sid, Catalog.cost}(Catalog \bowtie Product)))$

$R3 := \sigma_{S1.cost\;\geq\; S2.cost \; \cdot \;1.2 }(\sigma_{S1.sid\;!= \;S2.sid}(R1 \times R1))$

$R4 := \rho_{(sid)}(\pi_{S1.sid}(R3))$
\\~\\
vi)

$R1 := \rho_{P1}(Catalog)$

$R2 := \rho_{P2}(Catalog)$

$R3 := P1 \times P2$

$R4 := \sigma_{(P1.pid = P2.pid)\; \wedge\; (P1.sid != P2.sid)}(R3)$

$R5 := \rho_{(pid)}(\pi_{P1.pid}(R4))$
\\~\\
vii)

$R1 := \sigma_{tagname='Super Tech'}(ProductTag) \bowtie Suppliers$

$R2 := \rho_{R2(sid, cost)}(\sigma_{scountry = 'USA'}(R1))$

$R3 := \rho_{R3}(R2)$

$R4 := \rho_{R4(sid, cost)}(R2 \bowtie_{R2.cost < R3.cost}(R3))$

$R5 := R2 - R4$

$R6 := \pi_{sid}(R5)$
\\~\\
viii)

$R1 := \sigma_{tagname='Super Tech'}(ProductTag) \bowtie Suppliers$

$R2 := \rho_{R2(sid, cost)}(\sigma_{scountry = 'USA'}(R1))$

$R3 := \rho_{R3}(R2)$

$R4 := \rho_{R4(sid, cost)}(R2 \bowtie_{R2.cost < R3.cost}(R3))$

$R5 := R2 - R4$ [Most Expensive]

$R6 := R2 - R5$ [Table excluding most expensive]

$R7 := \rho_{R7(sid, cost)}(\sigma_{scountry = 'USA'}(R6))$

$R8 := \rho_{R8}(R7)$

$R9 := \rho_{R9(sid, cost)}(R7 \bowtie_{R7.cost < R8.cost}(R8))$

$R10 := R6 - R9$

$R11 := \pi_{sid}(R10)$
\\~\\
ix)

$R1 := \rho_{R1(pid, sid, cost)}(\pi_{Product.pid, Suppliers.sid}(Product \bowtie Catalog \bowtie Suppliers))$

$R2 := \pi_{pid}(R1)$

$R3 := R1 \div R2$

$R4 := \sigma_{cost<69}(R3)$

$R5 := \pi_{sid}(R4)$
\\~\\
x) $\pi_{pid}(Product \bowtie \sigma_{quantity=0}(Inventory))$
\\~\\
c)
\\~\\
i) For each pair of suppliers that have a “business relationship” ($^{*1}$) with each other, find pids they both offer in their catalog, but which we do not have inventory of. Return the sid for each supplier as sid1, and sid2, as well as the pid and cost. 
\\~\\
- Get the needed columns from subsuppliers

$R1 := \pi_{sid, subid}(Subsuppliers)$

- Create copies of catalog

$R2 := \rho_{C1}(Catalog)$

$R3 := \rho_{C2}(Catalog)$

- Create a table where each business relation is in a tuple with the different combinations of products from supplier and sub

$R4 := R1 \bowtie_{sid = C1.sid}(C1)$

$R5 := R4 \bowtie_{subid = C2.sid}(C2)$

- Get the products in common

$R6 := \sigma_{C1.pid = C2.pid}(R5)$

- Join with the inventory table to find the ones with 0 quantity

$R7 := R6 \bowtie_{C1.pid = Inventory.pid}(Inventory)$

$R8 := \sigma_{quantity = 0}(R7)$

- Format into desired format

$R9 := \rho_{R9(sid1, sid2, pid, cost)}\pi_{sid, subid, C1.pid, cost}(R8)$
\\~\\
ii) Find each pid, find the suppliers that have the products listed in their catalog at the exact same price. Return columns containing the pid, sid, cost. 
\\~\\
$R1 := \rho_{C1}(Catalog)$

$R2 := \rho_{C2}(Catalog)$

$R3 := C1 \times C2$ FIX DIVISIION

$R4 := \sigma_{C1.pid = C2.pid \wedge C1.sid != C2.sid \wedge C1.cost = C2.cost}(R3)$

$R5 := \rho_{R5(pid, sid, cost)}(\pi_{C1.pid, C1.sid, C1.cost}(R4))$
\\~\\
iii) Find the pids that have been listed as at least 3 different tags. However, one of the tags must be ‘PPE’, and one of them must not be ‘Super Tech’. Return columns containing the pid, pname, cost. 
\\~\\

\\~\\
iv) For each pair of “reciprocal subsuppliers”($^{*2}$), find all of their “uncommon subsuppliers”($^{*3}$). Every uncommon subsupplier of the pair should have only one row. Return the sid of the reciprocal subsuppliers, along with the sid, name and email of the uncommon subsupplier. 
\\~\\
\end{document}